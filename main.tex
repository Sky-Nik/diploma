\documentclass[a4paper,14pt,openany,twoside,oldfontcommands]{memoir}
\input{sty/use.sty}
\input{sty/th.bw.sty}
\input{sty/cmd.sty}
\usepackage{pdflscape}

\geometry{left=2.5cm,right=1.0cm,top=2.0cm,bottom=2.0cm} 
\hypersetup{unicode,colorlinks,linkcolor={blue},citecolor={blue!50!black},urlcolor={blue!80!black}}

\setmainfont{Times New Roman}
\setlength{\parindent}{1.27cm}
\linespread{1.25}
\setlist[itemize]{nosep}
\setlist[enumerate]{nosep}

\renewcommand{\printtoctitle}{\centering\bfseries\MakeUppercase}
\renewcommand{\printchapternonum}{\centering}
\renewcommand{\printchaptername}[3]{\centering \textsc{\textbf{\thechapter \ }}}
\renewcommand{\chaptitlefont}{\normalfont\bfseries}
\setsecheadstyle{\normalfont\bfseries}   
\setsubsecheadstyle{\normalfont\bfseries}

\setlength{\beforechapskip}{0pt}
\setlength{\afterchapskip}{20pt}

\fancypagestyle{plain}{%
  \fancyhf{} % clear all header and footer fields
  \fancyhead[R]{\thepage} %RO=right odd, RE=right even
  \fancyhead[L]{}
  \renewcommand{\headrulewidth}{0pt}
  \renewcommand{\footrulewidth}{0pt}
}
\pagestyle{plain}

\pretocmd{\section}{%
  \ifnum\value{section}=0 \else\clearpage\fi
}{}{}

\begin{document}

\pagenumbering{gobble}
\input{tex/title}
\newpage

\pagenumbering{arabic}
\setcounter{page}{2}

\input{tex/referat}
\newpage

\setcounter{tocdepth}{3}
\tableofcontents*
\newpage

\chapter{Вступ}
\input{tex/intro}

\chapter{Алгоритми}
\input{tex/algo}

\chapter{Задачі}
\input{tex/problem}

\begin{landscape}
\chapter{Результати}
\input{tex/result}
\end{landscape}

\chapter[Висновок]{\MakeUppercase{Висновок}}
\input{tex/conclusions}

\newpage
\nocite{*}
\bibliographystyle{gost780s}
\bibliography{tex/all.bib}

\appendix

\addtocontents{toc}{\setlength\cftchapternumwidth{5.5em}}
\renewcommand\thechapter{Додаток А}

\chapter{Реалізація}
\renewcommand\thechapter{A}

\input{tex/code}

\end{document}
